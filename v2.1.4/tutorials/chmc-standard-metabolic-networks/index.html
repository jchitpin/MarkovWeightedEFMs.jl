<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>CHMC (metabolic networks) · MarkovWeightedEFMs.jl</title><meta name="title" content="CHMC (metabolic networks) · MarkovWeightedEFMs.jl"/><meta property="og:title" content="CHMC (metabolic networks) · MarkovWeightedEFMs.jl"/><meta property="twitter:title" content="CHMC (metabolic networks) · MarkovWeightedEFMs.jl"/><meta name="description" content="Documentation for MarkovWeightedEFMs.jl."/><meta property="og:description" content="Documentation for MarkovWeightedEFMs.jl."/><meta property="twitter:description" content="Documentation for MarkovWeightedEFMs.jl."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.svg" alt="MarkovWeightedEFMs.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">MarkovWeightedEFMs.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><span class="tocitem">Home</span><ul><li><a class="tocitem" href="../../">MarkovWeightedEFMs.jl</a></li></ul></li><li><span class="tocitem">Installation</span><ul><li><a class="tocitem" href="../../installation/installation/">Getting started</a></li><li><a class="tocitem" href="../../installation/python-dependencies/">Exact Python dependencies for RXNMapper</a></li></ul></li><li><span class="tocitem">Tutorials</span><ul><li class="is-active"><a class="tocitem" href>CHMC (metabolic networks)</a><ul class="internal"><li><a class="tocitem" href="#Problem-statement"><span>Problem statement</span></a></li><li><a class="tocitem" href="#Inputs"><span>Inputs</span></a></li><li><a class="tocitem" href="#Solving-for-EFM-sequences,-probabilities,-and-weights"><span>Solving for EFM sequences, probabilities, and weights</span></a></li><li><a class="tocitem" href="#Visualizing-the-CHMC"><span>Visualizing the CHMC</span></a></li></ul></li><li><a class="tocitem" href="../chmc-standard-ion-channels/">CHMC (ion channels)</a></li><li><a class="tocitem" href="../chmc-atomic-glucose/">ACHMC (for AEFMs; quickstart)</a></li><li><a class="tocitem" href="../chmc-atomic-glucose-under-the-hood/">ACHMC (for AEFMs; under the hood)</a></li><li><a class="tocitem" href="../boilerplate-for-bigg-gems/">Boilerplate code for ACHMC analysis of BiGG models</a></li></ul></li><li><span class="tocitem">Library</span><ul><li><a class="tocitem" href="../../library/chmc-standard/">CHMC</a></li><li><a class="tocitem" href="../../library/chmc-atomic/">Atomic CHMC</a></li><li><a class="tocitem" href="../../library/chmc-plots-standard/">Plotting (CHMC)</a></li><li><a class="tocitem" href="../../library/chmc-plots-atomic/">Plotting (ACHMC)</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Tutorials</a></li><li class="is-active"><a href>CHMC (metabolic networks)</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>CHMC (metabolic networks)</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/jchitpin/MarkovWeightedEFMs.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/jchitpin/MarkovWeightedEFMs.jl/blob/main/docs/src/tutorials/chmc-standard-metabolic-networks.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="CHMC-(metabolic-networks)"><a class="docs-heading-anchor" href="#CHMC-(metabolic-networks)">CHMC (metabolic networks)</a><a id="CHMC-(metabolic-networks)-1"></a><a class="docs-heading-anchor-permalink" href="#CHMC-(metabolic-networks)" title="Permalink"></a></h1><p>This section demonstrates how to use the functions in MarkovWeightedEFMs.jl to analyze the following unimolecular reaction network.</p><p><img src="../../assets/toy-network-1.png" alt="Example unimolecular reaction network"/></p><h2 id="Problem-statement"><a class="docs-heading-anchor" href="#Problem-statement">Problem statement</a><a id="Problem-statement-1"></a><a class="docs-heading-anchor-permalink" href="#Problem-statement" title="Permalink"></a></h2><p>Given the metabolic network above, its steady state fluxes, and its elementary flux modes (EFMs), what is the set of EFM weights that reconstructs the observed network fluxes?</p><h2 id="Inputs"><a class="docs-heading-anchor" href="#Inputs">Inputs</a><a id="Inputs-1"></a><a class="docs-heading-anchor-permalink" href="#Inputs" title="Permalink"></a></h2><p>For this type of problem, we require the following:</p><ol><li>Stoichiometry matrix of unimolecular reactions (must be unimolecular and strongly-connected; either open or closed loop)</li><li>Steady state fluxes along each reaction.</li></ol><p>The network metabolites and reactions are typically encoded in an <span>$m$</span> by <span>$r$</span> stoichiometry matrix <code>S</code>. The steady state flux vector is stored as a separate vector.</p><pre><code class="language-julia hljs">using MarkovWeightedEFMs # load package

# Stoichiometry matrix and flux vector for the example network
S = [#
 -1  0  0  0  0  0  0  0  0  0  1
  1 -1  1 -1  0  0  0  0  0  0  0
  0  1 -1  0 -1  1  0  0  0  0  0
  0  0  0  1  0  0 -1  0  0  0  0
  0  0  0  0  1 -1  1 -1 -1  1  0
  0  0  0  0  0  0  0  1  0  0 -1
  0  0  0  0  0  0  0  0  1 -1  0
]
v = [3, 2, 1, 2, 3, 2, 2, 3, 1, 1, 3]</code></pre><p>We can check that the flux vector satisfies the steady state requirements.</p><pre><code class="language-julia hljs">all(S * v .== 0) # should evaluate as true</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">true</code></pre><h2 id="Solving-for-EFM-sequences,-probabilities,-and-weights"><a class="docs-heading-anchor" href="#Solving-for-EFM-sequences,-probabilities,-and-weights">Solving for EFM sequences, probabilities, and weights</a><a id="Solving-for-EFM-sequences,-probabilities,-and-weights-1"></a><a class="docs-heading-anchor-permalink" href="#Solving-for-EFM-sequences,-probabilities,-and-weights" title="Permalink"></a></h2><p>The following function applies our (discrete-time) cycle-history Markov chain (CHMC) method to compute the network EFMs, their steady state EFM probabilities, and weights. By default, the last parameter is 1 and can be omitted from the function. This parameter is the (arbitrary) initial state to root the CHMC. The choice of root state does not change the EFM probabilities or weights and is explained further in the section below.</p><pre><code class="language-julia hljs">res = steady_state_efm_distribution(S, v, 1)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">CHMCStandardSummary([[3, 2, 3], [6, 1, 2, 3, 5, 6], [3, 2, 4, 5, 3], [3, 5, 3], [7, 5, 7], [6, 1, 2, 4, 5, 6]], [0.10638297872340424, 0.19148936170212763, 0.042553191489361694, 0.2553191489361702, 0.14893617021276592, 0.2553191489361702], [0.7142857142857143, 1.2857142857142858, 0.2857142857142857, 1.7142857142857144, 0.9999999999999999, 1.7142857142857144])</code></pre><p>The enumerated EFM sequences are</p><pre><code class="language-julia hljs">res.e</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">6-element Vector{Vector{Int64}}:
 [3, 2, 3]
 [6, 1, 2, 3, 5, 6]
 [3, 2, 4, 5, 3]
 [3, 5, 3]
 [7, 5, 7]
 [6, 1, 2, 4, 5, 6]</code></pre><p>The corresponding EFM probabilities are</p><pre><code class="language-julia hljs">res.p</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">6-element Vector{Float64}:
 0.10638297872340424
 0.19148936170212763
 0.042553191489361694
 0.2553191489361702
 0.14893617021276592
 0.2553191489361702</code></pre><p>The corresponding EFM weights are</p><pre><code class="language-julia hljs">res.w</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">6-element Vector{Float64}:
 0.7142857142857143
 1.2857142857142858
 0.2857142857142857
 1.7142857142857144
 0.9999999999999999
 1.7142857142857144</code></pre><p>We can check that the EFM weights reconstruct the observed network fluxes</p><pre><code class="language-julia hljs">E = reshape_efm_vector(res.e, S) # matrix of EFM weights
E * res.w ≈ v # passes</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">true</code></pre><p>A binary EFM matrix with rows = # reactions and columns = # EFMs can be converted back to the array of EFM sequences by</p><pre><code class="language-julia hljs">reshape_efm_matrix(E, S)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">6-element Vector{Vector{Int64}}:
 [2, 3, 2]
 [1, 2, 3, 5, 6, 1]
 [3, 2, 4, 5, 3]
 [3, 5, 3]
 [5, 7, 5]
 [1, 2, 4, 5, 6, 1]</code></pre><h2 id="Visualizing-the-CHMC"><a class="docs-heading-anchor" href="#Visualizing-the-CHMC">Visualizing the CHMC</a><a id="Visualizing-the-CHMC-1"></a><a class="docs-heading-anchor-permalink" href="#Visualizing-the-CHMC" title="Permalink"></a></h2><p>The following plotting function visualizes the CHMC rooted on a metabolite state (1 by default).</p><pre><code class="language-julia hljs">using GLMakie # Makie backend
GLMakie.activate!()
T = stoichiometry_to_transition_matrix(S, v)
plot_chmc(T, 1) # the last parameter is the rooted metabolite index</code></pre><p><img src="../../assets/toy-network-1-chmc-makie.png" alt/></p><p>If using the GLMakie backend, ensure OpenGL is installed on your machine and accessible by Julia. The GLMakie plot is interactive and allows users to drag nodes and zoom in/out. Otherwise, you could choose another backend such as CairoMakie to generate and save a static plot. A prettier, hand-coded version of the transformed network is shown below.</p><p>The blue node is the root of the tree and the green nodes indicate that there is an edge back up to the root. By default, these arrows are omitted to avoid cluttering the plot.</p><p><img src="../../assets/toy-network-1-chmc.png" alt/></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../../installation/python-dependencies/">« Exact Python dependencies for RXNMapper</a><a class="docs-footer-nextpage" href="../chmc-standard-ion-channels/">CHMC (ion channels) »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.10.1 on <span class="colophon-date" title="Saturday 5 April 2025 04:44">Saturday 5 April 2025</span>. Using Julia version 1.10.9.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
